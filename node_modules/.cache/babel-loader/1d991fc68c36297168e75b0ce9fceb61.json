{"ast":null,"code":"import jwt_decode from 'jwt-decode';\nimport axios from 'axios';\n\nconst updateAuth = (state, action) => {\n  if (state === undefined) {\n    return {\n      isAuth: false,\n      currentUserId: null,\n      signUpSuccess: false,\n      username: null\n    };\n  } // console.log(action)\n\n\n  switch (action.type) {\n    case 'USER_SIGNUP':\n      return {\n        signUpSuccess: !state.signUpSuccess,\n        isAuth: false,\n        currentUserId: null,\n        username: null\n      };\n\n    case 'USER_LOGIN':\n      const payload = jwt_decode(action.payload);\n\n      if (payload.exp < new Date().getTime() / 1000) {\n        return {\n          signUpSuccess: false,\n          isAuth: false,\n          currentUserId: null,\n          username: null\n        };\n      }\n\n      axios.defaults.headers.common[\"Authorization\"] = `Bearer ${action.payload}`;\n      return {\n        signUpSuccess: false,\n        isAuth: true,\n        currentUserId: payload.user_id,\n        username: payload.user_id\n      };\n\n    case 'USER_LOGOUT':\n      localStorage.removeItem('access_token');\n      delete axios.defaults.headers.common[\"Authorization\"];\n      return {\n        signUpSuccess: false,\n        isAuth: false,\n        currentUserId: null,\n        username: null\n      };\n\n    default:\n      return state.auth;\n  }\n};\n\nexport default updateAuth;","map":{"version":3,"sources":["/Users/yeldarlimton/Desktop/Desktop_Yeldar/study/java/shop/spring-client/src/reducers/auth-reducer.js"],"names":["jwt_decode","axios","updateAuth","state","action","undefined","isAuth","currentUserId","signUpSuccess","username","type","payload","exp","Date","getTime","defaults","headers","common","user_id","localStorage","removeItem","auth"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,YAAvB;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAGA,MAAMC,UAAU,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;AAElC,MAAID,KAAK,KAAKE,SAAd,EAAyB;AACrB,WAAO;AACHC,MAAAA,MAAM,EAAE,KADL;AAEHC,MAAAA,aAAa,EAAE,IAFZ;AAGHC,MAAAA,aAAa,EAAE,KAHZ;AAIHC,MAAAA,QAAQ,EAAE;AAJP,KAAP;AAMH,GATiC,CAWlC;;;AACA,UAAOL,MAAM,CAACM,IAAd;AACI,SAAK,aAAL;AACI,aAAO;AACHF,QAAAA,aAAa,EAAE,CAACL,KAAK,CAACK,aADnB;AAEHF,QAAAA,MAAM,EAAE,KAFL;AAGHC,QAAAA,aAAa,EAAE,IAHZ;AAIHE,QAAAA,QAAQ,EAAE;AAJP,OAAP;;AAMJ,SAAK,YAAL;AACI,YAAME,OAAO,GAAGX,UAAU,CAACI,MAAM,CAACO,OAAR,CAA1B;;AACA,UAAGA,OAAO,CAACC,GAAR,GAAc,IAAIC,IAAJ,GAAWC,OAAX,KAAuB,IAAxC,EAA8C;AAC1C,eAAO;AACHN,UAAAA,aAAa,EAAE,KADZ;AAEHF,UAAAA,MAAM,EAAE,KAFL;AAGHC,UAAAA,aAAa,EAAE,IAHZ;AAIHE,UAAAA,QAAQ,EAAE;AAJP,SAAP;AAMH;;AACDR,MAAAA,KAAK,CAACc,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,IAAkD,UAASb,MAAM,CAACO,OAAQ,EAA1E;AACA,aAAO;AACHH,QAAAA,aAAa,EAAE,KADZ;AAEHF,QAAAA,MAAM,EAAE,IAFL;AAGHC,QAAAA,aAAa,EAAEI,OAAO,CAACO,OAHpB;AAIHT,QAAAA,QAAQ,EAAEE,OAAO,CAACO;AAJf,OAAP;;AAMJ,SAAK,aAAL;AACIC,MAAAA,YAAY,CAACC,UAAb,CAAwB,cAAxB;AACA,aAAOnB,KAAK,CAACc,QAAN,CAAeC,OAAf,CAAuBC,MAAvB,CAA8B,eAA9B,CAAP;AACA,aAAO;AACHT,QAAAA,aAAa,EAAE,KADZ;AAEHF,QAAAA,MAAM,EAAE,KAFL;AAGHC,QAAAA,aAAa,EAAE,IAHZ;AAIHE,QAAAA,QAAQ,EAAE;AAJP,OAAP;;AAMJ;AACI,aAAON,KAAK,CAACkB,IAAb;AAnCR;AAqCH,CAjDD;;AAmDA,eAAenB,UAAf","sourcesContent":["import jwt_decode from 'jwt-decode'\nimport axios from 'axios'\n\n\nconst updateAuth = (state, action) => {\n\n    if (state === undefined) {\n        return {\n            isAuth: false,\n            currentUserId: null,\n            signUpSuccess: false,\n            username: null\n        };\n    }\n\n    // console.log(action)\n    switch(action.type){\n        case 'USER_SIGNUP':\n            return {\n                signUpSuccess: !state.signUpSuccess,\n                isAuth: false,\n                currentUserId: null,\n                username: null\n            }\n        case 'USER_LOGIN':\n            const payload = jwt_decode(action.payload)\n            if(payload.exp < new Date().getTime() / 1000) {\n                return {\n                    signUpSuccess: false,\n                    isAuth: false,\n                    currentUserId: null,\n                    username: null\n                }\n            }\n            axios.defaults.headers.common[\"Authorization\"] = `Bearer ${action.payload}`\n            return {\n                signUpSuccess: false,\n                isAuth: true,\n                currentUserId: payload.user_id,\n                username: payload.user_id\n            }\n        case 'USER_LOGOUT':\n            localStorage.removeItem('access_token')\n            delete axios.defaults.headers.common[\"Authorization\"]\n            return {\n                signUpSuccess: false,\n                isAuth: false,\n                currentUserId: null,\n                username: null\n            }\n        default:\n            return state.auth;\n    }\n};\n\nexport default updateAuth;\n\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}